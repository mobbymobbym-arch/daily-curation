---
name: podcast-summary
description: 🎙️ Podcast 雲端深度敘事摘要工作流。當收到 Podcast 連結並要求「進行摘要」或類似指令時觸發。採用「行政官 (Flash)」校驗完整性與「分析官 (Pro)」進行極致敘事寫作。
---

# Podcast 雲端深度敘事摘要工作流

本技能旨在將 Podcast 內容轉化為高品質、深度敘事風格的摘要。核心原則是「完整性高於一切」。

## 核心策略與角色分配

- **行政官 (Flash)**：負責來源校驗、素材獲取及格式淨化。確保素材為「完整音檔」或「完整逐字稿」。
- **分析官 (Pro)**：調動 `google/gemini-3-pro-preview`，負責深度的全篇分析與寫作。

## 觸發機制

當接收到 Podcast 連結（Spotify, Apple Podcasts, YouTube, RSS 等）並得到「進行摘要」、「總結內容」或類似指令時。

## 工作流階段

### 第一階段：素材獲取與誠實校驗 (行政官)

1. **來源診斷 (智慧下載策略)**：
    - **策略 A (YouTube)**：搜尋節目是否有影片版，優先使用其完整逐字稿。
    - **策略 B (直接下載)**：嘗試使用 `yt-dlp` 下載音檔。
    - **策略 C (RSS 提取)**：若前兩項失敗，搜尋 RSS Feed 提取 MP3 下載連結（Enclosure URL）。
    - **驗收**：確認檔案下載完整（檔案大小 >10MB）。
2. **完整性聲明 (硬約束)**：
    - 必須確認素材覆蓋完整時長。
    - **禁止擅自合成**：若素材不完整，必須暫停並向 Joyce 報告，嚴禁直接開始摘要。
3. **進度回報**：長時間任務需每 20 分鐘回報一次狀態。

### 第二階段：極致敘事寫作 (分析官)

**強制模型要求**：必須使用 `google/gemini-3-pro-preview` 進行寫作。

**寫作規範 (The Pro Prompt)**：
- **開頭**：主持人與來賓身份背景介紹（各一句話）。
- **核心主題**：50-100 字深度摘要。
- **時空切割**：按時間軸每 10-15 分鐘切割章節。
- **內容深度**：單一章節需達 500-700 字繁體中文。嚴禁列點，使用流暢報導文學風格，適度加入 🌵。
- **細節引用**：每章節包含至少一處原話引用並標註說話者。
- **結尾**：附上單集原始連結。

### 第三階段：格式淨化與驗收 (行政官)

1. **來源標註**：開頭標註「素材來源」（例如：完整 MP3 音訊分析）。
2. **純淨交付**：移除所有 JSON 與 Markdown 程式碼標記（交付純文字）。
3. **清理戰場**：摘要完成後，自動刪除暫存檔與相關 Cron 任務。
4. **自動網頁渲染 (DoD)**：強制執行 `python3 scripts/render_podcast.py`，將摘要內容寫入首頁並自動處理歷史存檔。
5. **正式發布更新 (DoD)**：強制執行 `python3 scripts/publish.py`，將更新推送到 GitHub Pages 網站。
6. **目錄索引規範**：在網站的 Podcast 目錄區建立連結時，該連結必須指向「本網站內發布該摘要當天的內部存檔網頁（如：archive/YYYY-MM-DD.html）」，嚴禁直接連結至外部原始來源。

## 資源與工具

- `yt-dlp`：用於多平台音訊下載。
- `whisper`：若只有音檔時，用於生成逐字稿（需檢查現有環境 venv/whisper_env）。
- 腳本位置：`scripts/` 下的自動化處理腳本。
