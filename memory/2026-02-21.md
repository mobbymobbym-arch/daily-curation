# 2026-02-21 任務日誌 - 門戶網站「局部更新」與「雙軌存檔」系統實作 (v5.2)

## 🌟 關鍵進展
- **Daily News Curation (v5.0 -> v5.2)**:
    - **Task A (08:01)**: 成功執行。
        - **Techmeme**: 15 則 (Phil Spencer 退休、Claude Code 發布)。因 Chrome Relay 未連接，自動降級使用 `web_fetch`。
        - **WSJ**: 10 則 (Reliance AI 投資)。
        - **Deep Analysis**: Dwarkesh Podcast (Dario Amodei 訪談)。
    - **Task B (Surgical Render)**: 應主人要求，將渲染邏輯從全頁重寫改為「外科手術式」局部更新。
        - **領土標籤**: 在 `index.html` 植入 `<!-- DAILY_NEWS_START -->` 與 `<!-- DAILY_NEWS_END -->` 作為邊界。
        - **渲染腳本**: 創建 `scripts/render_news.py`。
            - 功能：讀取 `daily_news_temp.json` -> 生成 HTML 片段 -> 正則表達式替換 `index.html` 指定區塊。
            - 樣式：Techmeme 顯示來源名稱 (如 `New York Times →`)；WSJ 包含中英摘要；Deep Analysis 實作「展開/收合」互動 UI。
        - **自動化流程**: 更新 Cron Job (Task B) 執行順序：`render_news.py` -> 備份至 `archive/` -> `update_archives.py` -> Git Push。

- **雙軌目錄分類系統 (Dual-Track Inventory) 升級**:
    - **問題修復**: 解決了 `update_archives.py` 盲目掃描導致日報目錄混入 Podcast 專題檔的錯誤。
    - **領土標籤擴展**: 在 `index.html` 底部存檔區植入 `DAILY_INVENTORY` 與 `PODCAST_INVENTORY` 標籤對。
    - **邏輯重構**: 覆寫 `scripts/update_archives.py`。
        - **自動分流**: 嚴格區分 `YYYY-MM-DD.html` (日報) 與 `YYYY-MM-DD-*.html` (Podcast)。
        - **動態標題**: Podcast 存檔現在會自動抓取 HTML 內的 `<h3>` 作為目錄連結文字。
        - **內部連結規範**: 確保存檔目錄連結一律指向 `archive/` 內部的 HTML 檔案，不再指向外部原始來源。

- **Podcast 摘要流程 (v2.6) 穩固化**:
    - **渲染腳本**: 建立 `scripts/render_podcast.py`，負責將 `podcast_data.json` 內容精準注入 `PODCAST_HIGHLIGHTS` 領土。
    - **測試案例**: 成功處理 "Meta's Massive, Underappreciated Bet on AI" (Ben Thompson) 專訪。
    - **執行教訓**: 發生了嚴重的「標題誤認」事件（將 Ben Thompson 誤認為 Dario Amodei）。已在 Skill 指令中強制加入「第一階段標題校驗」步驟。

## ⚠️ 技術筆記
- **腳本位置**: 所有自動化腳本現在統一存放於 `scripts/` 目錄。
- **邊界意識**: 系統現在擁有四對核心領土標籤 (`DAILY_NEWS`, `PODCAST_HIGHLIGHTS`, `DAILY_INVENTORY`, `PODCAST_INVENTORY`)，任何手動或自動修改必須尊重這些邊界。
- **檔案命名**: 專題存檔建議使用 `YYYY-MM-DD-topic.html` 格式，以便雙軌系統識別。

## 待辦事項
- 觀察明日 (2/22) Cron Job 自動執行時，局部更新是否如預期運作（特別是 Podcast 區塊的保留）。
